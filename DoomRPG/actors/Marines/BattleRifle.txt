ACTOR DRPGMarineGuardBattleRifle
{
  Health 100
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 256
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  +FRIENDLY
  +MISSILEMORE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  Obituary "The UAC decided to terminate %o's employment."
  Species "Human"
  Tag "Marine"
  SeeSound ""
  PainSound "drpgmarinemale2/pain"
  DeathSound "drpgmarinemale2/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NEGATIVEXP | MF_NOPAYKILL | MF_NODROPS)
    TNT1 A 0
	Goto Idle
  Idle:
    TNT1 A 0 A_CheckFlag("FRIENDLY", 1, AAPTR_DEFAULT)
	Goto FuriousIdle
    NMA1 B 10 A_SetTics (random(1,10))
    TNT1 A 0 A_Jump (20, "Idle2")
    NMA1 AAAA 35
    TNT1 A 0 A_Jump (5, "Idle2")
    NMA1 A 35
    Goto Idle+5
  Idle2:
    NMA1 B 10 A_SetTics (random(1,10))
    NMA1 CCCC 35
    TNT1 A 0 A_Jump (5, "Idle")
    NMA1 C 35
    Goto Idle2+5
  FuriousIdle:
    NMA1 A 5 A_Look
    Loop
  See:
    TNT1 A 0 A_Jump (192, 2)
    TNT1 A 0 A_PlaySound("drpgmarinemale2/sight", CHAN_VOICE)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    NMA1 A 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA1 A 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA1 B 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA1 B 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA1 C 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA1 C 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA1 D 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA1 D 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    TNT1 A 0
    Goto See+2
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
	Goto See+2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA1 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA1 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA1 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA1 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA1 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA1 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA1 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA1 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
	Goto TargetReset
  TargetReset:
    TNT1 A 0 A_TakeInventory ("DRPGMarineGuardChaseCounter", 100)
    TNT1 A 0 A_ClearTarget
    Goto FuriousIdle
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA1 AA 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA1 BB 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA1 CC 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA1 DD 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_JumpIfCloser (220, 7)
    NMA1 EEEEEEEEEE 1 A_FaceTarget (10)
  MissileCheck:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfCloser (700, 1)
	Goto MissileSnipe
    TNT1 A 0 A_JumpIfCloser (220, 1)
	Goto MissileBurst
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_MonsterRefire(80, "Overwatch")
    Goto MissileCheck
  MissileBurst:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    NMA1 EEEEEEEEEE 1 A_FaceTarget (10)
    NMA1 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  MissileSnipe:
    TNT1 A 0 A_Jump (256,1,10,15,20,25)
    NMA1 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (16, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  Reload:
    NMA1 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NMA1 EEEEEEEE 4
    NMA1 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NMA1 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NMA1 EEEEEE 1 A_FaceTarget (10)
    Goto See+2
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA1 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA1 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (200, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See+2
  Pain:
    TNT1 A 0 A_CheckFlag("FRIENDLY", "GotShot", AAPTR_DEFAULT)
	Goto PainContinue
  PainContinue:
    NMA1 G 3
    NMA1 G 3 A_Pain
    Goto See+2
  GotShot:
    TNT1 A 0 A_ChangeFlag ("NOPAIN", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/betrayal", CHAN_VOICE)
	TNT1 A 0 ACS_NamedExecuteAlways("PissOffMarines", 0)
    Goto Enraged
  Enraged:
    TNT1 A 0 A_ChangeFlag ("FRIENDLY", 0)
    NMA1 G 6
    TNT1 A 0 A_ChangeFlag ("NOPAIN", 0)
    Goto See+2
  Death:
    NMA1 H 4
    NMA1 I 4 A_Scream
    NMA1 J 4 A_NoBlocking
    NMA1 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA1 LM 4
    NMA1 N -1
    Stop
  XDeath:
    NMA1 O 4
    NMA1 P 4 A_XScream
    NMA1 Q 4 A_NoBlocking
    NMA1 PQ 4
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA1 RSTUV 4
    NMA1 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

ACTOR DRPGMarineBattleRifle
{
  Health 100
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 256
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  +MISSILEMORE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  Obituary "The UAC decided to terminate %o's employment."
  Species "Human"
  Tag "Marine"
  SeeSound "drpgmarinemale2/sight"
  PainSound "drpgmarinemale2/pain"
  DeathSound "drpgmarinemale2/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NEGATIVEXP | MF_NOPAYKILL | MF_NODROPS)
	Goto SpawnSearch
  SpawnSearch:
    NMA1 A 3 A_Wander
    TNT1 A 0 A_Look
    NMA1 A 3 A_Wander
    TNT1 A 0 A_Look
    NMA1 B 3 A_Wander
    TNT1 A 0 A_Look
    NMA1 B 3 A_Wander
    TNT1 A 0 A_Look
    NMA1 C 3 A_Wander
    TNT1 A 0 A_Look
    NMA1 C 3 A_Wander
    TNT1 A 0 A_Look
    NMA1 D 3 A_Wander
    TNT1 A 0 A_Look
    NMA1 D 3 A_Wander
    TNT1 A 0 A_Look
    Loop
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    NMA1 AABBCCDD 3 A_Chase
    Loop
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
	Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA1 AABBCCDD 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NMA1 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NMA1 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NMA1 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NMA1 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NMA1 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NMA1 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NMA1 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
	Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA1 AA 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA1 BB 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA1 CC 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA1 DD 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_JumpIfCloser (220, 7)
    NMA1 EEEEEEEEEE 1 A_FaceTarget (10)
  MissileCheck:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfCloser (700, 1)
	Goto MissileSnipe
    TNT1 A 0 A_JumpIfCloser (220, 1)
	Goto MissileBurst
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_MonsterRefire(80, "Overwatch")
    Goto MissileCheck
  MissileBurst:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    NMA1 EEEEEEEEEE 1 A_FaceTarget (10)
    NMA1 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  MissileSnipe:
    TNT1 A 0 A_Jump (256,1,10,15,20,25)
    NMA1 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (16, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA1 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  Reload:
    NMA1 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NMA1 EEEEEEEE 4
    NMA1 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NMA1 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NMA1 EEEEEE 1 A_FaceTarget (10)
    Goto See
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA1 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA1 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (200, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  Pain:
    NMA1 G 3
    NMA1 G 3 A_Pain
    Goto See
  Death:
    NMA1 H 4
    NMA1 I 4 A_Scream
    NMA1 J 4 A_NoBlocking
    NMA1 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA1 LM 4
    NMA1 N -1
    Stop
  XDeath:
    NMA1 O 4
    NMA1 P 4 A_XScream
    NMA1 Q 4 A_NoBlocking
    NMA1 PQ 4
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA1 RSTUV 4
    NMA1 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

Actor DRPGMarineBattleRifleShotCounter : Inventory
{
inventory.maxamount 20
}

ACTOR DRPGMarineFemGuardBattleRifle
{
  Health 100
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 256
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  +FRIENDLY
  +MISSILEMORE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  Obituary "The UAC decided to terminate %o's employment."
  Species "Human"
  Tag "Marine"
  SeeSound ""
  PainSound "drpgmarinefemale1/pain"
  DeathSound "drpgmarinefemale1/death"
  ActiveSound "drpgmarinefemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NEGATIVEXP | MF_NOPAYKILL | MF_NODROPS)
    TNT1 A 0
	Goto Idle
  Idle:
    TNT1 A 0 A_CheckFlag("FRIENDLY", 1, AAPTR_DEFAULT)
	Goto FuriousIdle
    NM11 B 10 A_SetTics (random(1,10))
    TNT1 A 0 A_Jump (20, "Idle2")
    NM11 AAAA 35
    TNT1 A 0 A_Jump (5, "Idle2")
    NM11 A 35
    Goto Idle+5
  Idle2:
    NM11 B 10 A_SetTics (random(1,10))
    NM11 CCCC 35
    TNT1 A 0 A_Jump (5, "Idle")
    NM11 C 35
    Goto Idle2+5
  FuriousIdle:
    NM11 A 5 A_Look
    Loop
  See:
    TNT1 A 0 A_Jump (192, 2)
    TNT1 A 0 A_PlaySound("drpgmarinefemale1/sight", CHAN_VOICE)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    NM11 A 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NM11 A 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NM11 B 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NM11 B 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NM11 C 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NM11 C 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NM11 D 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NM11 D 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    TNT1 A 0
    Goto See+2
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
	Goto See+2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NM11 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NM11 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NM11 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NM11 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NM11 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NM11 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NM11 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NM11 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
	Goto TargetReset
  TargetReset:
    TNT1 A 0 A_TakeInventory ("DRPGMarineGuardChaseCounter", 100)
    TNT1 A 0 A_ClearTarget
    Goto FuriousIdle
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NM11 AA 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NM11 BB 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NM11 CC 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NM11 DD 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_JumpIfCloser (220, 7)
    NM11 EEEEEEEEEE 1 A_FaceTarget (10)
  MissileCheck:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfCloser (700, 1)
	Goto MissileSnipe
    TNT1 A 0 A_JumpIfCloser (220, 1)
	Goto MissileBurst
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_MonsterRefire(80, "Overwatch")
    Goto MissileCheck
  MissileBurst:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    NM11 EEEEEEEEEE 1 A_FaceTarget (10)
    NM11 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  MissileSnipe:
    TNT1 A 0 A_Jump (256,1,10,15,20,25)
    NM11 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (16, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  Reload:
    NM11 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NM11 EEEEEEEE 4
    NM11 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NM11 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NM11 EEEEEE 1 A_FaceTarget (10)
    Goto See+2
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NM11 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NM11 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (200, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See+2
  Pain:
    TNT1 A 0 A_CheckFlag("FRIENDLY", "GotShot", AAPTR_DEFAULT)
	Goto PainContinue
  PainContinue:
    NM11 G 3
    NM11 G 3 A_Pain
    Goto See+2
  GotShot:
    TNT1 A 0 A_ChangeFlag ("NOPAIN", 1)
	TNT1 A 0 ACS_NamedExecuteAlways("PissOffMarines", 0)
    Goto Enraged
  Enraged:
    TNT1 A 0 A_ChangeFlag ("FRIENDLY", 0)
    NM11 G 6
    TNT1 A 0 A_ChangeFlag ("NOPAIN", 0)
    Goto See+2
  Death:
    NM11 H 4
    NM11 I 4 A_Scream
    NM11 J 4 A_NoBlocking
    NM11 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NM11 LM 4
    NM11 N -1
    Stop
  XDeath:
    NM11 O 4
    NM11 P 4 A_XScream
    NM11 Q 4 A_NoBlocking
    NM11 PQ 4
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NM11 RSTUV 4
    NM11 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

ACTOR DRPGMarineFemBattleRifle
{
  Health 100
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 256
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  +MISSILEMORE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  Obituary "The UAC decided to terminate %o's employment."
  Species "Human"
  Tag "Marine"
  SeeSound "drpgmarinefemale1/sight"
  PainSound "drpgmarinefemale1/pain"
  DeathSound "drpgmarinefemale1/death"
  ActiveSound "drpgmarinefemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NEGATIVEXP | MF_NOPAYKILL | MF_NODROPS)
	Goto SpawnSearch
  SpawnSearch:
    NM11 A 3 A_Wander
    TNT1 A 0 A_Look
    NM11 A 3 A_Wander
    TNT1 A 0 A_Look
    NM11 B 3 A_Wander
    TNT1 A 0 A_Look
    NM11 B 3 A_Wander
    TNT1 A 0 A_Look
    NM11 C 3 A_Wander
    TNT1 A 0 A_Look
    NM11 C 3 A_Wander
    TNT1 A 0 A_Look
    NM11 D 3 A_Wander
    TNT1 A 0 A_Look
    NM11 D 3 A_Wander
    TNT1 A 0 A_Look
    Loop
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    NM11 AABBCCDD 3 A_Chase
    Loop
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
	Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NM11 AABBCCDD 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NM11 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NM11 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NM11 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NM11 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NM11 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NM11 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto Overwatch
    NM11 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
	Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NM11 AA 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NM11 BB 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NM11 CC 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NM11 DD 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_JumpIfCloser (220, 7)
    NM11 EEEEEEEEEE 1 A_FaceTarget (10)
  MissileCheck:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfCloser (700, 1)
	Goto MissileSnipe
    TNT1 A 0 A_JumpIfCloser (220, 1)
	Goto MissileBurst
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_MonsterRefire(80, "Overwatch")
    Goto MissileCheck
  MissileBurst:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_FaceTarget
    NM11 EEEEEEEEEE 1 A_FaceTarget (10)
    NM11 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  MissileSnipe:
    TNT1 A 0 A_Jump (256,1,10,15,20,25)
    NM11 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NM11 F 3 Bright A_CustomBulletAttack (16, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NM11 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  Reload:
    NM11 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NM11 EEEEEEEE 4
    NM11 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NM11 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NM11 EEEEEE 1 A_FaceTarget (10)
    Goto See
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NM11 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NM11 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (200, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  Pain:
    NM11 G 3
    NM11 G 3 A_Pain
    Goto See
  Death:
    NM11 H 4
    NM11 I 4 A_Scream
    NM11 J 4 A_NoBlocking
    NM11 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NM11 LM 4
    NM11 N -1
    Stop
  XDeath:
    NM11 O 4
    NM11 P 4 A_XScream
    NM11 Q 4 A_NoBlocking
    NM11 PQ 4
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NM11 RSTUV 4
    NM11 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}


ACTOR DRPGMarineShopkeeperBattleRifle 19996
{
  Health 100
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 256
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  +FRIENDLY
  +MISSILEMORE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  Obituary "The UAC decided to sell death to %o."
  Species "Human"
  Tag "Marine"
  SeeSound ""
  PainSound "drpgmarinemale3/pain"
  DeathSound "drpgmarinemale3/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NEGATIVEXP | MF_NOPAYKILL | MF_NODROPS)
    TNT1 A 0
	Goto Idle
  Idle:
    TNT1 A 0 A_CheckFlag("FRIENDLY", 1, AAPTR_DEFAULT)
	Goto FuriousIdle
    NMA0 B 10 A_SetTics (random(1,10))
    TNT1 A 0 A_Jump (20, "Idle2")
    NMA0 AAAA 35
    TNT1 A 0 A_Jump (5, "Idle2")
    NMA0 A 35
    Goto Idle+5
  Idle2:
    NMA0 B 10 A_SetTics (random(1,10))
    NMA0 CCCC 35
    TNT1 A 0 A_Jump (5, "Idle")
    NMA0 C 35
    Goto Idle2+5
  FuriousIdle:
    NMA0 A 5 A_Look
    Loop
  See:
    TNT1 A 0 A_Jump (192, 2)
    TNT1 A 0 A_PlaySound("drpgmarinemale3/sight", CHAN_VOICE)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    NMA0 A 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA0 A 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA0 B 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA0 B 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA0 C 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA0 C 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA0 D 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    NMA0 D 3 A_Chase
    TNT1 A 0 A_JumpIfTargetInLOS (3, 0, JLOSF_CLOSENOSIGHT, 0, 512)
    TNT1 A 0 A_GiveInventory ("DRPGMarineGuardChaseCounter", 1)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineGuardChaseCounter", 100, "TargetReset")
    TNT1 A 0
    Goto See+2
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
	Goto See+2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA0 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA0 A 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA0 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA0 B 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA0 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA0 C 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA0 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, 1)
	Goto TargetReset
    NMA0 D 2 A_Chase
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
	Goto TargetReset
  TargetReset:
    TNT1 A 0 A_TakeInventory ("DRPGMarineGuardChaseCounter", 100)
    TNT1 A 0 A_ClearTarget
    Goto FuriousIdle
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA0 AA 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA0 BB 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA0 CC 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    NMA0 DD 2 A_Chase ("", "")
    TNT1 A 0 A_JumpIfCloser (180, 2)
    TNT1 A 0 A_Jump (24, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_JumpIfCloser (220, 7)
    NMA0 EEEEEEEEEE 1 A_FaceTarget (10)
  MissileCheck:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfCloser (700, 1)
	Goto MissileSnipe
    TNT1 A 0 A_JumpIfCloser (220, 1)
	Goto MissileBurst
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA0 F 3 Bright A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA0 E 1 A_MonsterRefire(80, "Overwatch")
    Goto MissileCheck
  MissileBurst:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA0 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA0 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA0 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA0 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA0 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA0 E 1 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA0 F 3 Bright A_CustomBulletAttack (19, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA0 E 1 A_FaceTarget
    NMA0 EEEEEEEEEE 1 A_FaceTarget (10)
    NMA0 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  MissileSnipe:
    TNT1 A 0 A_Jump (256,1,10,15,20,25)
    NMA0 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA0 F 3 Bright A_CustomBulletAttack (16, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuff", 0, CBAF_NORANDOM)
    NMA0 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  Reload:
    NMA0 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NMA0 EEEEEEEE 4
    NMA0 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NMA0 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NMA0 EEEEEE 1 A_FaceTarget (10)
    Goto See+2
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA0 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA0 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (200, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See+2
  Pain:
    TNT1 A 0 A_CheckFlag("FRIENDLY", "GotShot", AAPTR_DEFAULT)
	Goto PainContinue
  PainContinue:
    NMA0 G 3
    NMA0 G 3 A_Pain
    Goto See+2
  GotShot:
    TNT1 A 0 A_ChangeFlag ("NOPAIN", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/betrayal", CHAN_VOICE)
	TNT1 A 0 ACS_NamedExecuteAlways("PissOffMarines", 0)
    Goto Enraged
  Enraged:
    TNT1 A 0 A_ChangeFlag ("FRIENDLY", 0)
    NMA0 G 6
    TNT1 A 0 A_ChangeFlag ("NOPAIN", 0)
    Goto See+2
  Death:
    NMA0 H 4
    NMA0 I 4 A_Scream
    NMA0 J 4 A_NoBlocking
    NMA0 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA0 LM 4
    NMA0 N -1
    Stop
  XDeath:
    NMA0 O 4
    NMA0 P 4 A_XScream
    NMA0 Q 4 A_NoBlocking
    NMA0 PQ 4
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA0 RSTUV 4
    NMA0 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}
